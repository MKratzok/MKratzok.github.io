<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <meta name="description" content ="Highly Recommended Word Web">
    <meta name="keywords" content="Mellow Max, WMFO, 91.5, Radio, Interview, Vero Strange, Sarika, Gotye, Amyl and the Sniffers, Q-Tip Bandits, Pooop, College Radio, Boston, Cambridge, Tufts University, Little Fuss, Tiny Fuss, Q-Tip Bandits, Bermuda Search Party, Freeform Radio, On the Town with Mikey Dee, Highly Recommended, Wednesday, 7-9pm, Music, Radio, Max, Mellow, Mellow Max, Max Kratzok, Maxmellow (like a marshmellow), Is there such a thing as too many tags???, #seo, #loveme, #doyoulikepinacoladas">
    <meta name="author" content="Max Kratzok">
    <title>Music Word Cloud</title>
    <link rel="icon" href="Website favicon - 48px.ico" type="image/x-icon">
    <link rel="shortcut icon" href="Website favicon - 48px.ico" type="image/x-icon">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            text-align: center;
            margin: 20px;
        }

        .wordweb {
          position: relative;
          width: 250vh;
          height: 95vh;
          overflow: auto;
        }

        .artist {
          position: absolute;
          font-family: "Cooper";
          white-space: nowrap;
          line-height: 1;
          padding: 1px 2px;
          user-select: none;
        }

    </style>
</head>

<body>

<div class="wordweb" id="wordweb"></div>

<script>
let container;
let artists;
const CELL = 6;
const MAX_TRIES = 400;

function layout() {
    const W = container.clientWidth;
    const H = container.clientHeight;

    /* Occupancy grid */
    const cols = Math.ceil(W / CELL);
    const rows = Math.ceil(H / CELL);
    const grid = new Uint8Array(cols * rows);

    const mark = (x, y, w, h) => {
        const x0 = Math.floor(x / CELL);
        const y0 = Math.floor(y / CELL);
        const x1 = Math.ceil((x + w) / CELL);
        const y1 = Math.ceil((y + h) / CELL);

        for (let yy = y0; yy < y1; yy++)
            for (let xx = x0; xx < x1; xx++)
                grid[yy * cols + xx] = 1;
    };

    const free = (x, y, w, h) => {
        if (x < 0 || y < 0 || x + w > W || y + h > H) return false;

        const x0 = Math.floor(x / CELL);
        const y0 = Math.floor(y / CELL);
        const x1 = Math.ceil((x + w) / CELL);
        const y1 = Math.ceil((y + h) / CELL);

        for (let yy = y0; yy < y1; yy++)
            for (let xx = x0; xx < x1; xx++)
                if (grid[yy * cols + xx]) return false;

        return true;
    };

    /* Alphabetical ordering preserved by index */
    const sorted = artists.slice(); // keep original order
    const N = sorted.length;

sorted.forEach((el, i) => {
    const r = el.getBoundingClientRect();

    // alphabetical target Y
    const targetY = (i / (N - 1)) * H;

    let placed = false;

    // spiral radius grows each attempt
    for (let t = 0; t < MAX_TRIES && !placed; t++) {
        const radius = t * 3; // grows slowly
        const angle = Math.random() * Math.PI * 2;

        const x = (W / 2) + Math.cos(angle) * radius - r.width / 2;
        const y = targetY + Math.sin(angle) * radius - r.height / 2;

        if (free(x, y, r.width, r.height)) {
            mark(x, y, r.width, r.height);
            el._x = x;
            el._y = y;
            placed = true;
        }
    }

    if (!placed) {
        // fallback: drop anywhere free
        for (let t = 0; t < MAX_TRIES && !placed; t++) {
            const x = Math.random() * (W - r.width);
            const y = Math.random() * (H - r.height);

            if (free(x, y, r.width, r.height)) {
                mark(x, y, r.width, r.height);
                el._x = x;
                el._y = y;
                placed = true;
            }
        }
    }
});


    /* Final paint */
    artists.forEach(el => {
        if (el._x != null)
            el.style.transform = `translate(${el._x}px, ${el._y}px)`;
    });
}


fetch("wordwebvalues2025.html")
  .then(r => r.text())
  .then(html => {
    document.getElementById("wordweb").innerHTML = html;

    container = document.querySelector('.wordweb');
    artists = [...document.querySelectorAll('.artist')];

    // Apply font sizes and absolute positioning BEFORE measuring
    artists.forEach(el => {
        const w = +el.dataset.weight || 1;
        el.style.fontSize = `${15 + w*3}px`;
        el.style.position = "absolute";
        el.style.left = "0px";
        el.style.top = "0px";
    });

    // Force layout flush so sizes are correct
    container.offsetHeight;

    layout();
    window.addEventListener('resize', () => {
        layout();
    });
});
</script>

<script src="https://d3js.org/d3.v7.min.js"></script>


</body>

</html>